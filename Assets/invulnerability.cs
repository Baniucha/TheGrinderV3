using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class invulnerability : MonoBehaviour
{
    public MeshRenderer rend;
    public ParticleSystem blood;
    public  Color colorHit;
    public Color colorInvincible;
    bool invincible;
    public Player playerhp;
    public float dmg;
    private void Awake()
    {
        dmg = 5;
        blood.gameObject.SetActive(false);
    }
    private void Start()
    {
        invincible = false;
        rend.GetComponent<MeshRenderer>();
        colorHit = Color.red;
        colorInvincible = Color.white;
    }
    private void Update()
    {

    }
    private void OnTriggerEnter2D(Collider2D collision)
    {
        if((collision.gameObject.tag=="Fire"||collision.gameObject.tag=="Enemy"||collision.gameObject.tag=="EnemyLadder")&&!invincible )
        {
            PlayerTakesDmg(dmg);
            this.gameObject.GetComponent<Renderer>().material.color = Color.red ;
            invincible = true;
            Invoke("Invulnerability", 2);
            if (!blood.gameObject.active)
            {
                blood.gameObject.SetActive(true);
            }
        }
        
    }
    private void OnTriggerStay2D(Collider2D collision)
    {
        if (collision.gameObject.tag == "Fire" && !invincible)
        {
            PlayerTakesDmg(dmg);
            this.gameObject.GetComponent<Renderer>().material.color = Color.red;
            invincible = true;
            Invoke("Invulnerability", 2);
        }
        if ((collision.gameObject.tag == "Enemy"||collision.gameObject.tag=="EnemyLadder") && !invincible)
        {
            PlayerTakesDmg(dmg);
            this.gameObject.GetComponent<Renderer>().material.color = Color.red;
            invincible = true;
            Invoke("Invulnerability", 2);
        }
    }
   public void Invulnerability()
    {
        invincible = false;
        this.gameObject.GetComponent<Renderer>().material.color = Color.white;
    }
    public void PlayerTakesDmg(float dmg)
    {
        blood.time = 0;
        blood.Play();
        playerhp.actualHealth -= dmg;
    }
}
